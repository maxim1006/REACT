<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<!--https://github.com/romabelka/js_ru_29_03/tree/master/src - ссылка на репо-->

<!--
    Реакт - это только вью, у него по умолчанию нет апи для работы с сервером и т.д.

    Реакт - это архитектура

    Flux - архитектурный паттерн, который использую для построения бизнес логики. Ключевая разница с MVC, MVVM, односторонний поток данных в отличие от двухстороннего. Он нужен для бизнес логики - работы с данными в сторе, а реакт - это тула как отобразить вью.

    Состоит из Action (сущность, которая позволяет нам взаимодействовать с бизнес логикой и вообще отвечает за коммуникацию с нашим приложением, то что торчит наружу), который попадает в Dispatcher (отвечает за то как экшн попадает в стор, в каком поярдке), а тот распределяется по всем Store (структура, которая сохраняет данные, умеет их обрабатывать, реагировать на влияние извне и оповещать об этом вью), Store обновляются и сообщают об этом вью. Этот паттерн из плюсов: прозрачный, легкий дебаг, всегда можем пройтись по пунктам и спокойно отдебажить. Redux - реализация самая популярная, в старых проектах flux.

Сторы могут вызывать экшены

Селект или ремув - это user Interaction, сперва делаю их, в файле article.js, тем самым реализую какую-то логику, по которой преобразуется компонент, дальше нужно создать action creator (в папке AC)


Далее ac должны вызывать action, которые будут вызывать диспетчер (для этого ставлю flux: npm i flux --SD) (файл dispatcher.js)

После создания диспетчера надо файлы в стор положить (папка store), создаю ArticleStore с логикой и index.js в /store, где инициализирую все сторы.

Стор хранит все моки, поэтому в app.js меняю входные данные на articles={articleStore.getAll()}

После создания стора, который умеет хранить и обрабатывать данные надо его подружить с диспетчиром, чтобы приходили экшены, поэтому подключаю диспетчер в стор (ArticleStore), и оттуда уже дергаю экшены

Затем надо оповещать вьюхи, для этого беру npm i events --SD, подключаю events в (ArticleStore), добавляю эвентэмиттер, для того, чтобы связать стор с вью (добавляю его в ArticleStore.js)

Далее надо сообщить вьюхам о том, что что-то поменялось, для этого создаю обертку над ArticleList - ArticleListContainer, в нем делаю ререндеринг ArticleList. Этот контейнер обеспечивает взаимодействие стор - вью

Всегда добавляю
removeChangeListener и componentWillUnmount

Выношу переменные в constants

Делаю абстрактный SimpleStore, чтобы каждый раз не писать сторы, в нем храню все что будет объеденять все сторы

Есть 2 вида компонент: 1) который получает данные и как-то их отображает 2) которые привязываются к стору, как то коммуницируют с бизнес логикой. Во флаксе есть термины: глупые и умные компоненты. Умные - работают со стором, глупые - с вью. Есть компоненты типо Article, которые вроде и для вью, но дергают AC, в таких случаях прослойку с AC вынести в props (ну и прокинуть по всей цепочки в article, articleList и везде в пропсы). Когда такой проброс слишком накладно делать можно и в обычные компоненты импорить AC.

Поэтому создаю папку containers, где храню умные компоненты.

Затем нужно задекларировать какие пропсы можно передавать, а какие нет. Для этого существуют propTypes (применяю в ArticleList.js)

Далее комменты прописываю в стор, и стор выношу в window для удобства дебага

Далее в dispatcher.js делаю возможность просматривать все экшены

Далее пытаюсь научить наши сторы работать друг с другом: в stores/index.js - пробрасываю все сторы, а в simpleStore делаю методы для работы с ними

Для того, чтобы достать из article комменты, делаю обертку для данных dataWrapper - которая добавляет relations между комментами и статьями.

Вся эта шняга, для того, чтобы сделать нормализированную работу с данными.

1) Сделал user-interaction (хендлер на событие, которое юзер сгенерировал)
2) создал action creator, который вызывается на юзер интерекшн (дергает диспетчер (dispatch))
3) создаю диспетчер (npm i flux)
4) создаю стор и связываю его с диспетчером
5) Делаю контейнер для взаимодействия между компонентом и стором
6) прикручиваю эвент эмиттер


Компоненты, которые общаются со стором должно быть немного и сторы нельзя использовать внутри глупых компонент.
-->




<div id="container"></div>
<div id="container1"></div>
<div id="container2"></div>
<div id="container3"></div>
<div id="container4"></div>


<script src="https://code.jquery.com/jquery-2.2.2.min.js"></script>

<!-- Class bundle -->
<script src="build/class.bundle.js"></script>

<!-- HW bundle -->
<!--<script src="build/hw.bundle.js"></script>-->

</body>
</html>